<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Communicating fees - Breez SDK - Greenlight</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../styles.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Breez SDK - Greenlight</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/breez/breez-sdk-docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/breez/breez-sdk-docs/edit/main/src/guide/communicating_fees.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="communicating-fees"><a class="header" href="#communicating-fees">Communicating fees</a></h1>
<p>In the LSP model, fees are involved when the user wants to receive a payment, but doesn't have a sufficient receivable amount. This section provides recommendations on how to communicate these fees to a user.</p>
<h2 id="before-receiving-a-lightning-payment">
    <a class="header" href="#before-receiving-a-lightning-payment">Before receiving a Lightning payment</a>
    <a class="tag" target="_blank" href="https://breez.github.io/breez-sdk-greenlight/breez_sdk_core/struct.BreezServices.html#method.open_channel_fee">API docs</a>
</h2>
<p>When the user wants to receive a payment, a setup fee is paid when the resulting invoice would exceed the receivable amount.
The setup fee is made up of two parts:</p>
<ul>
<li>A minimum fee</li>
<li>A proportional fee based on the amount</li>
</ul>
<p>Before creating an invoice, the amount the user will want to receive is yet unknown. It is recommended to show the user a message consisting of the following information:</p>
<blockquote>
<p>A setup fee of x% with a minimum of y sats will be applied for receiving more than z sats.</p>
</blockquote>
<p>You can construct this message as follows:</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">let inbound_liquidity_msat = sdk.node_info()?.max_receivable_single_payment_amount_msat;
let inbound_liquidity_sat = inbound_liquidity_msat / 1000;

let opening_fee_response = sdk
    .open_channel_fee(OpenChannelFeeRequest::default())
    .await?;

let opening_fees = opening_fee_response.fee_params;
let fee_percentage = (opening_fees.proportional * 100) as f64 / 1_000_000_f64;
let min_fee_sat = opening_fees.min_msat / 1_000;

if inbound_liquidity_sat == 0 {
    info!("A setup fee of {fee_percentage}% with a minimum of {min_fee_sat} sats will be applied.");
} else {
    info!("A setup fee of {fee_percentage}% with a minimum of {min_fee_sat} sats will be applied for receiving more than {inbound_liquidity_sat} sats.");
}</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">if let nodeInfo = try? sdk.nodeInfo() {
    let inboundLiquiditySat = nodeInfo.maxReceivableSinglePaymentAmountMsat / 1_000;

    let openingFeeResponse = try? sdk.openChannelFee(req: OpenChannelFeeRequest(amountMsat: nil));

    if let openingFees = openingFeeResponse?.feeParams {
        let feePercentage = Double(openingFees.proportional * 100) / 1_000_000.0;
        let minFeeSat = openingFees.minMsat / 1_000;

        if inboundLiquiditySat == 0 {
            print("A setup fee of \(feePercentage)% with a minimum of \(minFeeSat) sats will be applied.");
        } else {
            print("A setup fee of \(feePercentage)% with a minimum of \(minFeeSat) sats will be applied for receiving more than \(inboundLiquiditySat) sats.");
        }
    }
}
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">val inboundLiquidityMsat = sdk.nodeInfo()?.maxReceivableSinglePaymentAmountMsat ?: 0u
val inboundLiquiditySat = inboundLiquidityMsat / 1_000u

val openingFeeResponse = sdk.openChannelFee(OpenChannelFeeRequest(null))

val openingFees = openingFeeResponse.feeParams;
val feePercentage = (openingFees.proportional * 100u) / 1_000_000u
val minFeeSat = openingFees.minMsat / 1_000u;

if (inboundLiquiditySat == 0UL) {
    // Log.v("A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied.");
} else {
    // Log.v("A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied for receiving more than ${inboundLiquiditySat} sats.");
}
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">const nodeState = await nodeInfo()
const inboundLiquidityMsat = nodeState.maxReceivableSinglePaymentAmountMsat
const inboundLiquiditySat = inboundLiquidityMsat != null ? inboundLiquidityMsat / 1_000 : 0

const openChannelFeeResponse = await openChannelFee({})

const openingFees = openChannelFeeResponse.feeParams
const feePercentage = (openingFees.proportional * 100) / 1_000_000
const minFeeSat = openingFees.minMsat / 1_000

if (inboundLiquiditySat === 0) {
  console.log(`A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied.`)
} else {
  console.log(`A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied for receiving more than ${inboundLiquiditySat} sats.`)
}
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">NodeState? nodeInfo = await breezSDK.nodeInfo();
if (nodeInfo != null) {
  int inboundLiquiditySat = nodeInfo.maxReceivableSinglePaymentAmountMsat ~/ 1000;

  OpenChannelFeeResponse openingFeeResponse = await breezSDK.openChannelFee(req: OpenChannelFeeRequest());

  OpeningFeeParams openingFees = openingFeeResponse.feeParams;
  double feePercentage = (openingFees.proportional * 100) / 1000000;
  int minFeeSat = openingFees.minMsat ~/ 1000;

  if (inboundLiquiditySat == 0) {
      print("A setup fee of $feePercentage% with a minimum of $minFeeSat sats will be applied.");
  } else {
      print("A setup fee of $feePercentage% with a minimum of $minFeeSat sats will be applied for receiving more than $inboundLiquiditySat sats.");
  }
}
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore">inbound_liquidity_msat = sdk_services.node_info().max_receivable_single_payment_amount_msat
inbound_liquidity_sat = inbound_liquidity_msat / 1_000

opening_fee_response = sdk_services.open_channel_fee()

opening_fees = opening_fee_response.fee_params
fee_percentage = (opening_fees.proportional * 100)  / 1_000_000
min_fee_sat = opening_fees.min_msat / 1_000

if inbound_liquidity_sat == 0:
    print("A setup fee of ", fee_percentage, "% with a minimum of ", min_fee_sat, " sats will be applied.")
else:
    print(
        "A setup fee of ", fee_percentage, "% with a minimum of ", min_fee_sat, " sats will be applied "
        "for receiving more than ", inbound_liquidity_sat, " sats."
    )
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">nodeInfo, err := sdk.NodeInfo()
if err != nil {
    return err
}
var inboundLiquiditySat = nodeInfo.MaxReceivableSinglePaymentAmountMsat / 1_000

openingFeeResponse, err := sdk.OpenChannelFee(breez_sdk.OpenChannelFeeRequest{})
if err != nil {
    return err
}
var openingFees = openingFeeResponse.FeeParams
var feePercentage = (openingFees.Proportional * 100) / 1_000_000.0
var minFeeSat = openingFees.MinMsat / 1_000

if inboundLiquiditySat == 0 {
    log.Printf(
        "A setup fee of %v%% with a minimum of %v sats will be applied.",
        feePercentage, minFeeSat)
} else {
    log.Printf(
        "A setup fee of %v%% with a minimum of %v sats will be applied"+
            "for receiving more than %v sats.",
        feePercentage, minFeeSat, inboundLiquiditySat)
}
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">try
{
    var nodeInfo = sdk.NodeInfo();

    var inboundLiquiditySat = nodeInfo?.maxReceivableSinglePaymentAmountMsat / 1_000;

    var openingFeeResponse = sdk.OpenChannelFee(new OpenChannelFeeRequest(null));
    var openingFees = openingFeeResponse?.feeParams;
    if (openingFees != null)
    {
        var feePercentage = (openingFees.proportional * 100) / 1_000_000.0;
        var minFeeSat = openingFees.minMsat / 1_000;

        if (inboundLiquiditySat == 0)
        {
            Console.WriteLine(
                $"A setup fee of {feePercentage}% with a minimum of {minFeeSat} sats will be applied."
            );
        }
        else
        {
            Console.WriteLine(
                $"A setup fee of {feePercentage}% with a minimum of {minFeeSat} sats will be applied " +
                $"for receiving more than {inboundLiquiditySat} sats."
            );
        }
    }
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h2 id="after-creating-an-invoice"><a class="header" href="#after-creating-an-invoice">After creating an invoice</a></h2>
<p>After calling <code>receive_payment</code>, you would typically show the recipient a screen containing a QR code with the invoice that the sender can scan.</p>
<p>This is another place to show the user the opening fees applied to the invoice. At this point the amount the user wants to receive is known, so the message can be more concise:</p>
<blockquote>
<p>A setup fee of x sats is applied to this invoice.</p>
</blockquote>
<p>The fiat amount can also be included. In case of a mobile app it is recommended to communicate to the user that the app has to be run in the foreground in order to be able to receive the payment.</p>
<div class="warning">
<h4 id="developer-note"><a class="header" href="#developer-note">Developer note</a></h4>
Consider implementing the <a href="/notifications/getting_started.html">Notification Plugin</a> when using the Breez SDK in a mobile application. By registering a webhook the application can receive a payment notification to process the payment in the background.
</div>
<p>Here is how you can build this message:</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">let opening_fee_sat = receive_payment_response
    .opening_fee_msat
    .unwrap_or_default()
    / 1000;
info!("A setup fee of {opening_fee_sat} sats is applied to this invoice.");</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">let openingFeeSat = (receivePaymentResponse.openingFeeMsat ?? 0) / 1_000;
print("A setup fee of \(openingFeeSat) sats is applied to this invoice.")
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">val openingFeeSat = receivePaymentResponse.openingFeeMsat?.let{ it.div(1000UL).toULong() } ?: run { 0UL }
// Log.v("Breez", "A setup fee of ${openingFeeSat} sats is applied to this invoice.")
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">const openingFeeMsat = receivePaymentResponse.openingFeeMsat
const openingFeeSat = openingFeeMsat != null ? openingFeeMsat / 1000 : 0
console.log(`A setup fee of ${openingFeeSat} sats is applied to this invoice.`)
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">int openingFeeSat = (receivePaymentResponse.openingFeeMsat ?? 0) / 1000 as int;
print("A setup fee of $openingFeeSat sats is applied to this invoice.");
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore">opening_fee_msat = receive_payment_response.opening_fee_msat
opening_fee_sat = opening_fee_msat / 1_000 if opening_fee_msat is not None else 0
print("A setup fee of ", opening_fee_sat, " sats is applied to this invoice.")
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">var openingFeeSat int
openingFeeMsat := receivePaymentResponse.OpeningFeeMsat
if openingFeeMsat != nil {
    openingFeeSat = int(*openingFeeMsat / 1_000)
}
log.Printf("A setup fee of %v sats is applied to this invoice.", openingFeeSat)
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">var openingFeeSat = receivePaymentResponse.openingFeeMsat.GetValueOrDefault() / 1000;
Console.WriteLine($"A setup fee of {openingFeeSat} sats is applied to this invoice.");
</code></pre>
</section>
</custom-tabs>
<h2 id="sending-a-lightning-payment"><a class="header" href="#sending-a-lightning-payment">Sending a Lightning payment</a></h2>
<p>Routing fees for sending Lightning payments vary based on the available path, as some channels incur higher fees due to the distribution of liquidity across the network. Developers have the option to set limits on Lightning fees, which are capped by default at 1% of the payment amount. However, it's important to note that restricting fees can increase the likelihood of payment failures.</p>
<p>For users leveraging trampoline payments (recommended for reliabily), routing fees are currently fixed at 0.5% + 4 sat.</p>
<h2 id="receiving-an-on-chain-transaction">
    <a class="header" href="#receiving-an-on-chain-transaction">Receiving an on-chain transaction</a>
    <a class="tag" target="_blank" href="https://breez.github.io/breez-sdk-greenlight/breez_sdk_core/struct.BreezServices.html#method.receive_onchain">API docs</a>
</h2>
<p>For receiving onchain, there is a minimum and a maximum amount the user can receive. The fees are made up of the same components as receiving a lightning payment.</p>
<p>The user gets an onchain address from <code>receive_onchain</code>. There is no way to know ahead of time exactly the amount that will be received on this address, so it is recommended to show the user the receivable boundaries and the fees involved:</p>
<blockquote>
<p>Send more than v sats and up to w sats to this address. A setup fee of x% with a minimum of y sats will be applied for sending more than z sats. This address can only be used once.</p>
</blockquote>
<p>Below code sample constructs this message.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">let swap_info = sdk
    .receive_onchain(ReceiveOnchainRequest::default())
    .await?;

let min_deposit_sat = swap_info.min_allowed_deposit;
let max_deposit_sat = swap_info.max_allowed_deposit;
let inbound_liquidity_sat = sdk.node_info()?.max_receivable_single_payment_amount_msat / 1000;

if let Some(swap_opening_fees) = swap_info.channel_opening_fees {
    let fee_percentage = (swap_opening_fees.proportional * 100) as f64 / 1_000_000_f64;
    let min_fee_sat = swap_opening_fees.min_msat / 1_000;

    info!("Send more than {min_deposit_sat} sats and up to {max_deposit_sat} sats to this address. \
        A setup fee of {fee_percentage}% with a minimum of {min_fee_sat} sats will be applied \
        for sending more than {inbound_liquidity_sat} sats. This address can only be used once.");
}</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">let swapInfo = try? sdk.receiveOnchain(req: ReceiveOnchainRequest())

let minDepositSat = swapInfo!.minAllowedDeposit;
let maxDepositSat = swapInfo!.maxAllowedDeposit;

let nodeInfo = try? sdk.nodeInfo();
let inboundLiquiditySat = nodeInfo!.maxReceivableSinglePaymentAmountMsat / 1_000;

if let swapOpeningFees = swapInfo!.channelOpeningFees {
    let feePercentage = Double(swapOpeningFees.proportional * 100) / 1_000_000.0;
    let minFeeSat = swapOpeningFees.minMsat / 1_000;

    print("Send more than \(minDepositSat) sats and up to \(maxDepositSat) sats to this address. A setup fee of \(feePercentage)% with a minimum of \(minFeeSat) sats will be applied for sending more than \(inboundLiquiditySat) sats. This address can only be used once.");
}
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">val swapInfo = sdk.receiveOnchain(ReceiveOnchainRequest())

val minDepositSat = swapInfo.minAllowedDeposit
val maxDepositSat = swapInfo.maxAllowedDeposit
val inboundLiquiditySat = (sdk.nodeInfo()?.maxReceivableSinglePaymentAmountMsat ?: 0u) / 1_000u

val swapOpeningFees = swapInfo.channelOpeningFees
if (swapOpeningFees != null) {
    val feePercentage = (swapOpeningFees.proportional * 100u) / 1_000_000u
    val minFeeSat = swapOpeningFees.minMsat / 1_000u;

    // Log.v("Send more than ${minDepositSat} sats and up to ${maxDepositSat} sats to this address. A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied for sending more than ${inboundLiquiditySat} sats. This address can only be used once.");
}
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">const nodeState = await nodeInfo()
const swapInfo = await receiveOnchain({})

const minDepositSat = swapInfo.minAllowedDeposit
const maxDepositSat = swapInfo.maxAllowedDeposit
const inboundLiquidityMsat = nodeState?.maxReceivableSinglePaymentAmountMsat
const inboundLiquiditySat = inboundLiquidityMsat != null ? (inboundLiquidityMsat / 1_000) : 0

const swapOpeningFees = swapInfo.channelOpeningFees
if (swapOpeningFees != null) {
  const feePercentage = (swapOpeningFees.proportional * 100) / 1_000_000
  const minFeeSat = swapOpeningFees.minMsat / 1_000

  console.log(`Send more than ${minDepositSat} sats and up to ${maxDepositSat} sats to this address. A setup fee of ${feePercentage}% with a minimum of ${minFeeSat} sats will be applied for sending more than ${inboundLiquiditySat} sats. This address can only be used once.`)
}
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">SwapInfo swapInfo = await breezSDK.receiveOnchain(req: ReceiveOnchainRequest());

int minDepositSat = swapInfo.minAllowedDeposit;
int maxDepositSat = swapInfo.maxAllowedDeposit;

NodeState? nodeInfo = await breezSDK.nodeInfo();
if (nodeInfo != null) {
  int inboundLiquiditySat = nodeInfo.maxReceivableSinglePaymentAmountMsat ~/ 1000;

  OpeningFeeParams? swapOpeningFees = swapInfo.channelOpeningFees;
  if (swapOpeningFees != null) {
    double feePercentage = (swapOpeningFees.proportional * 100) / 1000000;
    int minFeeSat = swapOpeningFees.minMsat ~/ 1000;

    print("Send more than $minDepositSat sats and up to $maxDepositSat sats to this address. A setup fee of $feePercentage% with a minimum of $minFeeSat sats will be applied for sending more than $inboundLiquiditySat sats. This address can only be used once.");
  }
}
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore">swap_info = sdk_services.receive_onchain(breez_sdk.ReceiveOnchainRequest())

min_deposit_sat = swap_info.min_allowed_deposit
max_deposit_sat = swap_info.max_allowed_deposit
inbound_liquidity_sat = sdk_services.node_info().max_receivable_single_payment_amount_msat / 1_000

swap_opening_fees = swap_info.channel_opening_fees
if swap_opening_fees is not None:
    fee_percentage = (swap_opening_fees.proportional * 100)  / 1_000_000
    min_fee_sat = swap_opening_fees.min_msat / 1_000

    print(
        "Send more than ", min_deposit_sat, " sats and up to ", max_deposit_sat, " sats to this address. "
        "A setup fee of ", fee_percentage, "% with a minimum of ", min_fee_sat, " sats will be applied for "
        "sending more than ", inbound_liquidity_sat, " sats. This address can only be used once."
    )
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">swapInfo, err := sdk.ReceiveOnchain(breez_sdk.ReceiveOnchainRequest{})
if err != nil {
    return err
}
var minDepositSat = swapInfo.MinAllowedDeposit
var maxDepositSat = swapInfo.MaxAllowedDeposit

nodeInfo, err := sdk.NodeInfo()
if err != nil {
    return err
}
var inboundLiquiditySat = nodeInfo.MaxReceivableSinglePaymentAmountMsat / 1_000

var swapOpeningFees = swapInfo.ChannelOpeningFees
var feePercentage = (swapOpeningFees.Proportional * 100) / 1_000_000.0
var minFeeSat = swapOpeningFees.MinMsat / 1_000

log.Printf(
    "Send more than %v sats and up to %v sats to this address. "+
        "A setup fee of %v%% with a minimum of %v sats will be applied "+
        "for sending more than %v sats. This address can only be used once.",
    minDepositSat, maxDepositSat, feePercentage, minFeeSat, inboundLiquiditySat)
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">try
{
    var swapInfo = sdk.ReceiveOnchain(new ReceiveOnchainRequest());

    var minDepositSat = swapInfo?.minAllowedDeposit;
    var maxDepositSat = swapInfo?.maxAllowedDeposit;

    var nodeInfo = sdk.NodeInfo();
    var inboundLiquiditySat = nodeInfo?.maxReceivableSinglePaymentAmountMsat / 1_000;

    var swapOpeningFees = swapInfo?.channelOpeningFees;
    if (swapOpeningFees != null)
    {
        var feePercentage = (swapOpeningFees.proportional * 100) / 1_000_000.0;
        var minFeeSat = swapOpeningFees.minMsat / 1_000;

        Console.WriteLine(
            $"Send more than {minDepositSat} sats and up to {maxDepositSat} sats to this address. " +
            $"A setup fee of {feePercentage}% with a minimum of {minFeeSat} sats will be applied " +
            $"for sending more than {inboundLiquiditySat} sats. This address can only be used once."
        );
    }
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h2 id="sending-an-on-chain-transaction"><a class="header" href="#sending-an-on-chain-transaction">Sending an on-chain transaction</a></h2>
<p>Sending an on-chain transaction to a BTC address involves a trustless <a href="https://medium.com/breez-technology/reverse-submarine-swaps-another-step-towards-a-p2p-lightning-economy-bacb040fdca7">reverse swap</a>. Reverse swaps have a minimum transaction amount of 50,000 sats, which may increase during periods of high fees. The reverse swap provider, <a href="https://boltz.exchange/">Boltz</a>, charges a fixed service fee of 0.5% plus an additional mining fee based on current Bitcoin mempool usage.</p>
<p>Follow the instructions <a href="./pay_onchain.html">here</a> to calculate limits and fees.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../guide/pay_onchain.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../guide/lnurl.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../guide/pay_onchain.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../guide/lnurl.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../tabs.js"></script>


    </div>
    </body>
</html>
